<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="AGENT" >
  <resultMap id="BaseResultMap" type="com.icss.oa.work.pojo.Agent" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Jul 02 08:47:04 CST 2015.
    -->
    <id column="UA_ID" property="uaId" jdbcType="DECIMAL" />
    <result column="EMP_ID" property="empId" jdbcType="DECIMAL" />
    <result column="MANAGER_ID" property="managerId" jdbcType="DECIMAL" />
    <result column="AGENT" property="agent" jdbcType="DECIMAL" />
  </resultMap>
  
  <insert id="insert" parameterType="com.icss.oa.work.pojo.Agent" >
    insert into AGENT (UA_ID, EMP_ID, MANAGER_ID, AGENT
      )
    values (UA_SEQ.nextval, #{empId,jdbcType=DECIMAL}, #{managerId,jdbcType=DECIMAL}, 
    #{agent,jdbcType=DECIMAL}
      )
  </insert>
  
  <delete id="delete" parameterType="java.lang.Integer" >
    delete from AGENT
    where UA_ID = #{uaId,jdbcType=DECIMAL}
  </delete>
 
  <select id="query" resultMap="BaseResultMap" parameterType="java.util.Map">
			select * from (select rownum rnum,
			a.* from agent a)
			where rnum between #{start} and #{end}
  </select>
  
  <select id="simpleQuery" resultMap="BaseResultMap" parameterType="java.util.Map">
			select * from agent
  </select>
  
  <select id="queryByCondition" resultType="java.util.Map" parameterType="java.util.Map">
    select * from (select rownum rnum , a.* ,emp.emp_name emp_name,manager.emp_name manager_name,dept.dept_name emp_dept, pos.pos_name
     emp_pos,dept2.dept_name manager_dept,pos2.pos_name manager_pos from agent a
     left outer join employee emp on emp.emp_id = a.emp_id
     left outer join employee manager on manager.emp_id = a.manager_id
     left outer join department dept on emp.department_id = dept.dept_id
     left outer join position pos on emp.position_id = pos.pos_id
      left outer join department dept2 on manager.department_id = dept2.dept_id
     left outer join position pos2 on manager.position_id = pos2.pos_id 
      <where>
		    <if test="condition == 'emp'">
		        and a.emp_id = #{data,jdbcType=DECIMAL}
		    </if>
		    <if test="condition == 'manager'">
		        and a.manager_id = #{data,jdbcType=DECIMAL}
		    </if>
		    <if test="condition == 'agent' and data == 0">
		        and a.agent = 0
		    </if>
		    <if test="condition == 'agent' and data ==1">
		        and a.agent = 1
		    </if>
		</where>
		) m where rnum between #{start} and #{end} order by m.agent asc
  </select>
  
  <select id="getAgent" resultType="java.lang.Integer" parameterType="java.util.Map">
    select a.agent from agent a
    where a.emp_id = #{empId} and a.manager_id = #{managerId}
  </select>
  
  <select id="getCount" resultType="java.lang.Integer">
		select
		count(*)
		from agent
  </select>
  
  <select id="getConditionCount" resultType="java.lang.Integer" parameterType="java.util.Map">
		select
		count(*)
		from agent
		<where>
		    <if test="condition == 'emp'">
		        and agent.emp_id = #{data,jdbcType=DECIMAL}
		    </if>
		    <if test="condition == 'manager'">
		        and agent.manager_id = #{data,jdbcType=DECIMAL}
		    </if>
		   <if test="condition == 'agent' and data == 0">
		        and agent.agent = 0
		    </if>
		    <if test="condition == 'agent' and data ==1">
		        and agent.agent = 1
		    </if>
		</where>
  </select>
  
  <select id="getPrimaryKey" resultType="java.lang.Integer">
	    select ua_seq.currval from dual
  </select>
	
</mapper>